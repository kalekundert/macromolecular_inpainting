******************************
Use exponential moving average
******************************

State-of-the-art diffusion models (for 2D images) typically use a form of 
regularization where the weights are smoothed by an exponential moving average 
(EMA) during training.  Due to the prevalence of this technique, I wanted to 
try applying it to my models.
